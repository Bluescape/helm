---
apiVersion: v1
kind: ConfigMap
metadata:
  name: mongodb-dashboard

  labels:
     {{- include "bluescape-monitoring-dashboards-4.labels" . | nindent 4 }}
data:
  mongodb-dashboard.json: |-
        {
          "annotations": {
            "list": [
              {
                "builtIn": 1,
                "datasource": {
                  "type": "datasource",
                  "uid": "grafana"
                },
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "target": {
                  "limit": 100,
                  "matchAny": false,
                  "tags": [],
                  "type": "dashboard"
                },
                "type": "dashboard"
              }
            ]
          },
          "description": "MongoDB Prometheus Exporter Dashboard. A fork inspired from https://grafana.com/grafana/dashboards/2583 which is made to work well with https://github.com/percona/mongodb_exporter.",
          "editable": true,
          "fiscalYearStartMonth": 0,
          "gnetId": 14997,
          "graphTooltip": 1,
          "id": 136,
          "links": [],
          "liveNow": false,
          "panels": [
            {
              "collapsed": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 0
              },
              "id": 20,
              "panels": [],
              "repeat": "env",
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "refId": "A"
                }
              ],
              "title": "Query Metrics for $env",
              "type": "row"
            },
            {
              "aliasColors": {
                "command": "#7EB26D"
              },
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 10,
                "x": 0,
                "y": 1
              },
              "hiddenSeries": false,
              "id": 7,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "sum by(legacy_op_type)(irate(mongodb_ss_opcounters{instance=~\"$env\"}[$interval]))",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "range": true,
                  "refId": "A",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Query Operations",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:50",
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:51",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 8,
                "x": 10,
                "y": 1
              },
              "hiddenSeries": false,
              "id": 9,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "returned",
                  "yaxis": 1
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "sum by(doc_op_type)(irate(mongodb_ss_metrics_document{instance=~\"$env\"}[$interval]))",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "range": true,
                  "refId": "A",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Document Operations",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:252",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:253",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 6,
                "x": 18,
                "y": 1
              },
              "hiddenSeries": false,
              "id": 8,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "sum by(state)(rate(mongodb_ss_metrics_queryExecutor_scanned{instance=~\"$env\"}[$interval]))",
                  "format": "time_series",
                  "hide": false,
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "scanned_objects",
                  "range": true,
                  "refId": "A",
                  "step": 600
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Document Query Executor",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:335",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:336",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "collapsed": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 7
              },
              "id": 21,
              "panels": [],
              "repeat": "env",
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "refId": "A"
                }
              ],
              "title": "Replica Set Metrics for $env",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": true,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 6,
                "x": 0,
                "y": 8
              },
              "hiddenSeries": false,
              "id": 15,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": false,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_rs_members_health{instance=~\"$env\"}",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "# members",
                  "range": true,
                  "refId": "A",
                  "step": 600
                },
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "sum(mongodb_rs_members_health{instance=~\"$env\"})",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "healthy members",
                  "range": true,
                  "refId": "B",
                  "step": 600
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Member Health",
              "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "series",
                "show": false,
                "values": [
                  "current"
                ]
              },
              "yaxes": [
                {
                  "$$hashKey": "object:415",
                  "format": "none",
                  "logBase": 1,
                  "min": "0",
                  "show": true
                },
                {
                  "$$hashKey": "object:416",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "aliasColors": {},
              "bars": true,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "description": "See which node is currently acting as the primary, secondary, ...",
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 12,
                "x": 6,
                "y": 8
              },
              "hiddenSeries": false,
              "id": 14,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": false,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "exemplar": false,
                  "expr": "mongodb_rs_members_state{instance=~\"$env\"}",
                  "format": "time_series",
                  "instant": false,
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "refId": "A",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Member State",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "series",
                "show": false,
                "values": [
                  "current"
                ]
              },
              "yaxes": [
                {
                  "$$hashKey": "object:1154",
                  "format": "none",
                  "label": "",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:1155",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 6,
                "x": 18,
                "y": 8
              },
              "hiddenSeries": false,
              "id": 11,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "exemplar": false,
                  "expr": "sum by(legacy_op_type)(rate(mongodb_ss_opcounters{instance=~\"$env\"}[$interval]))",
                  "format": "time_series",
                  "instant": false,
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "refId": "A",
                  "step": 600
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Replica Query Operations",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:1483",
                  "format": "ops",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:1484",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "collapsed": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 14
              },
              "id": 22,
              "panels": [],
              "repeat": "env",
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "refId": "A"
                }
              ],
              "title": "Health metrics for $env",
              "type": "row"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "mode": "thresholds"
                  },
                  "mappings": [
                    {
                      "options": {
                        "match": "null",
                        "result": {
                          "text": "N/A"
                        }
                      },
                      "type": "special"
                    }
                  ],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "rgba(245, 54, 54, 0.9)",
                        "value": null
                      },
                      {
                        "color": "rgba(237, 129, 40, 0.89)",
                        "value": 0
                      },
                      {
                        "color": "rgba(50, 172, 45, 0.97)",
                        "value": 360
                      }
                    ]
                  },
                  "unit": "s"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 4,
                "w": 4,
                "x": 0,
                "y": 15
              },
              "id": 10,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "value",
                "graphMode": "none",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "lastNotNull"
                  ],
                  "fields": "",
                  "values": false
                },
                "textMode": "auto"
              },
              "pluginVersion": "9.3.6",
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_ss_uptime{instance=~\"$env\"}",
                  "format": "time_series",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "range": true,
                  "refId": "A",
                  "step": 1800
                }
              ],
              "title": "Uptime",
              "type": "stat"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "fixedColor": "rgb(31, 120, 193)",
                    "mode": "fixed"
                  },
                  "mappings": [
                    {
                      "options": {
                        "match": "null",
                        "result": {
                          "text": "N/A"
                        }
                      },
                      "type": "special"
                    }
                  ],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 80
                      }
                    ]
                  },
                  "unit": "none"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 4,
                "w": 4,
                "x": 4,
                "y": 15
              },
              "id": 2,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "none",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "mean"
                  ],
                  "fields": "",
                  "values": false
                },
                "textMode": "auto"
              },
              "pluginVersion": "9.3.6",
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_ss_connections{instance=~\"$env\",conn_type=\"available\"}",
                  "format": "time_series",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "metric": "mongodb_connections",
                  "range": true,
                  "refId": "A",
                  "step": 1800
                }
              ],
              "title": "Available Connections",
              "type": "stat"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fieldConfig": {
                "defaults": {
                  "color": {
                    "fixedColor": "rgb(31, 120, 193)",
                    "mode": "fixed"
                  },
                  "mappings": [
                    {
                      "options": {
                        "match": "null",
                        "result": {
                          "text": "N/A"
                        }
                      },
                      "type": "special"
                    }
                  ],
                  "thresholds": {
                    "mode": "absolute",
                    "steps": [
                      {
                        "color": "green",
                        "value": null
                      },
                      {
                        "color": "red",
                        "value": 80
                      }
                    ]
                  },
                  "unit": "none"
                },
                "overrides": []
              },
              "gridPos": {
                "h": 4,
                "w": 16,
                "x": 8,
                "y": 15
              },
              "hideTimeOverride": false,
              "id": 1,
              "links": [],
              "maxDataPoints": 100,
              "options": {
                "colorMode": "none",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "horizontal",
                "reduceOptions": {
                  "calcs": [
                    "mean"
                  ],
                  "fields": "",
                  "values": false
                },
                "textMode": "auto"
              },
              "pluginVersion": "9.3.6",
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_ss_connections{instance=~\"$env\",conn_type=\"current\"}",
                  "format": "time_series",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "metric": "mongodb_connections",
                  "range": true,
                  "refId": "A",
                  "step": 1800
                }
              ],
              "title": "Open Connections",
              "type": "stat"
            },
            {
              "collapsed": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 19
              },
              "id": 23,
              "panels": [],
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "refId": "A"
                }
              ],
              "title": "Resource Metrics",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 8,
                "x": 0,
                "y": 20
              },
              "hiddenSeries": false,
              "id": 6,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_oplog_stats_size{instance=~\"$env\"}",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "Stats",
                  "metric": "mongodb_locks_time_acquiring_global_microseconds_total",
                  "range": true,
                  "refId": "A",
                  "step": 240
                },
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_oplog_stats_maxSize{instance=~\"$env\"}",
                  "hide": false,
                  "legendFormat": "Max",
                  "range": true,
                  "refId": "B"
                },
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_oplog_stats_storageSize{instance=~\"$env\"}",
                  "hide": false,
                  "legendFormat": "Storage",
                  "range": true,
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Oplog Size",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:1566",
                  "format": "decbytes",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:1567",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 8,
                "x": 8,
                "y": 20
              },
              "hiddenSeries": false,
              "id": 4,
              "legend": {
                "alignAsTable": false,
                "avg": false,
                "current": true,
                "hideEmpty": false,
                "hideZero": false,
                "max": false,
                "min": false,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_sys_memory_MemTotal_kb{instance=~\"$env\"}",
                  "hide": false,
                  "legendFormat": "Total",
                  "range": true,
                  "refId": "A"
                },
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_sys_memory_MemAvailable_kb{instance=~\"$env\"}",
                  "hide": false,
                  "legendFormat": "available",
                  "range": true,
                  "refId": "B"
                },
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_sys_memory_MemFree_kb{instance=~\"$env\"}",
                  "hide": false,
                  "legendFormat": "Free",
                  "range": true,
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Memory",
              "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": [
                  "total"
                ]
              },
              "yaxes": [
                {
                  "$$hashKey": "object:1998",
                  "format": "deckbytes",
                  "label": "MB",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:1999",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 6,
                "w": 8,
                "x": 16,
                "y": 20
              },
              "hiddenSeries": false,
              "id": 5,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "mongodb_ss_metrics_repl_network_getmores_totalMillis",
                  "format": "time_series",
                  "instant": false,
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "Network_TotalMills",
                  "metric": "mongodb_metrics_operation_total",
                  "refId": "A",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Network I/O",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:1035",
                  "format": "decbytes",
                  "label": "B",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:1036",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "collapsed": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 26
              },
              "id": 24,
              "panels": [],
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "refId": "A"
                }
              ],
              "title": "Alerts",
              "type": "row"
            },
            {
              "alert": {
                "conditions": [
                  {
                    "evaluator": {
                      "params": [
                        300
                      ],
                      "type": "gt"
                    },
                    "operator": {
                      "type": "and"
                    },
                    "query": {
                      "params": [
                        "A",
                        "15m",
                        "now"
                      ]
                    },
                    "reducer": {
                      "params": [],
                      "type": "avg"
                    },
                    "type": "query"
                  }
                ],
                "executionErrorState": "keep_state",
                "frequency": "60s",
                "handler": 1,
                "message": "A MongoDB oplog replication has been 5 minutes behind in its replication for more than 15 minutes.\nBeing able to fail over to a replica of your data is only useful if the data is up to date, so you need to know when thatâ€™s no longer the case!",
                "name": "MongoDB Oplog lag alert",
                "noDataState": "no_data",
                "notifications": [
                  {
                    "id": 2
                  }
                ]
              },
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 12,
                "x": 0,
                "y": 27
              },
              "hiddenSeries": false,
              "id": 16,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "editorMode": "code",
                  "expr": "sum by(instance) (mongodb_ss_oplogTruncation_truncateCount{instance=~\"$instance\"})",
                  "format": "time_series",
                  "hide": false,
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "range": true,
                  "refId": "A",
                  "step": 240
                }
              ],
              "thresholds": [
                {
                  "$$hashKey": "object:2256",
                  "colorMode": "critical",
                  "fill": true,
                  "line": true,
                  "op": "gt",
                  "value": 300,
                  "yaxis": "left"
                }
              ],
              "timeRegions": [],
              "title": "Oplog Lag",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:585",
                  "format": "dtdurationms",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:586",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "alert": {
                "conditions": [
                  {
                    "evaluator": {
                      "params": [
                        0.98
                      ],
                      "type": "gt"
                    },
                    "operator": {
                      "type": "and"
                    },
                    "query": {
                      "params": [
                        "A",
                        "5m",
                        "now"
                      ]
                    },
                    "reducer": {
                      "params": [],
                      "type": "avg"
                    },
                    "type": "query"
                  }
                ],
                "executionErrorState": "keep_state",
                "frequency": "60s",
                "handler": 1,
                "message": "MongoDBs average disk i/o utilization has been above 98% for 5 minutes",
                "name": "MongoDBs Disk IO Utilization alert",
                "noDataState": "no_data",
                "notifications": [
                  {
                    "id": 2
                  }
                ]
              },
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 12,
                "x": 12,
                "y": 27
              },
              "hiddenSeries": false,
              "id": 17,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "rightSide": true,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "expr": "(rate(node_disk_io_time_seconds_total[5m])/1000 or irate(node_disk_io_time_seconds_total[5m])/1000)",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "refId": "A",
                  "step": 240
                }
              ],
              "thresholds": [
                {
                  "$$hashKey": "object:754",
                  "colorMode": "critical",
                  "fill": true,
                  "line": true,
                  "op": "gt",
                  "value": 0.98,
                  "visible": true,
                  "yaxis": "left"
                }
              ],
              "timeRegions": [],
              "title": "Disk IO Utilization",
              "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:736",
                  "format": "percentunit",
                  "label": "",
                  "logBase": 2,
                  "max": "1",
                  "show": true
                },
                {
                  "$$hashKey": "object:737",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "collapsed": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 34
              },
              "id": 25,
              "panels": [],
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "refId": "A"
                }
              ],
              "title": "Dashboard Row",
              "type": "row"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 12,
                "x": 0,
                "y": 35
              },
              "hiddenSeries": false,
              "id": 18,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "expr": "rate(node_disk_reads_completed_total[5m])",
                  "format": "time_series",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "refId": "A",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Disk Reads Completed",
              "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:109",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:110",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
              },
              "fill": 1,
              "fillGradient": 0,
              "gridPos": {
                "h": 7,
                "w": 12,
                "x": 12,
                "y": 35
              },
              "hiddenSeries": false,
              "id": 19,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": false,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "options": {
                "alertThreshold": true
              },
              "percentage": false,
              "pluginVersion": "9.3.6",
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "datasource": {
                    "type": "prometheus",
                    "uid": "PBFA97CFB590B2093"
                  },
                  "expr": "rate(node_disk_writes_completed_total[5m])",
                  "format": "time_series",
                  "intervalFactor": 2,
                  "legendFormat": "",
                  "refId": "A",
                  "step": 240
                }
              ],
              "thresholds": [],
              "timeRegions": [],
              "title": "Disk Writes Completed",
              "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "mode": "time",
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "$$hashKey": "object:810",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                },
                {
                  "$$hashKey": "object:811",
                  "format": "short",
                  "logBase": 1,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false
              }
            }
          ],
          "refresh": "5s",
          "schemaVersion": 37,
          "style": "dark",
          "tags": [
            "prometheus"
          ],
          "templating": {
            "list": [
              {
                "current": {
                  "selected": true,
                  "text": [
                    "All"
                  ],
                  "value": [
                    "$__all"
                  ]
                },
                "datasource": {
                  "type": "prometheus",
                  "uid": "PBFA97CFB590B2093"
                },
                "definition": "label_values(mongodb_up, instance)",
                "hide": 0,
                "includeAll": true,
                "label": "env",
                "multi": true,
                "name": "env",
                "options": [],
                "query": {
                  "query": "label_values(mongodb_up, instance)",
                  "refId": "StandardVariableQuery"
                },
                "refresh": 1,
                "regex": "",
                "skipUrlSync": false,
                "sort": 1,
                "type": "query",
                "useTags": false
              },
              {
                "auto": true,
                "auto_count": 30,
                "auto_min": "10s",
                "current": {
                  "selected": false,
                  "text": "auto",
                  "value": "$__auto_interval_interval"
                },
                "hide": 0,
                "name": "interval",
                "options": [
                  {
                    "selected": true,
                    "text": "auto",
                    "value": "$__auto_interval_interval"
                  },
                  {
                    "selected": false,
                    "text": "1m",
                    "value": "1m"
                  },
                  {
                    "selected": false,
                    "text": "10m",
                    "value": "10m"
                  },
                  {
                    "selected": false,
                    "text": "30m",
                    "value": "30m"
                  },
                  {
                    "selected": false,
                    "text": "1h",
                    "value": "1h"
                  },
                  {
                    "selected": false,
                    "text": "6h",
                    "value": "6h"
                  },
                  {
                    "selected": false,
                    "text": "12h",
                    "value": "12h"
                  },
                  {
                    "selected": false,
                    "text": "1d",
                    "value": "1d"
                  },
                  {
                    "selected": false,
                    "text": "7d",
                    "value": "7d"
                  },
                  {
                    "selected": false,
                    "text": "14d",
                    "value": "14d"
                  },
                  {
                    "selected": false,
                    "text": "30d",
                    "value": "30d"
                  }
                ],
                "query": "1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",
                "queryValue": "",
                "refresh": 2,
                "skipUrlSync": false,
                "type": "interval"
              },
              {
                "current": {
                  "selected": false,
                  "text": "10.64.113.179:9216",
                  "value": "10.64.113.179:9216"
                },
                "definition": "label_values(mongodb_ss_oplogTruncation_truncateCount, instance)",
                "hide": 0,
                "includeAll": false,
                "multi": false,
                "name": "instance",
                "options": [],
                "query": {
                  "query": "label_values(mongodb_ss_oplogTruncation_truncateCount, instance)",
                  "refId": "StandardVariableQuery"
                },
                "refresh": 1,
                "regex": "",
                "skipUrlSync": false,
                "sort": 0,
                "type": "query"
              }
            ]
          },
          "time": {
            "from": "now-30m",
            "to": "now"
          },
          "timepicker": {
            "refresh_intervals": [
              "5s",
              "10s",
              "30s",
              "1m",
              "5m",
              "15m",
              "30m",
              "1h",
              "2h",
              "1d"
            ],
            "time_options": [
              "5m",
              "15m",
              "1h",
              "6h",
              "12h",
              "24h",
              "2d",
              "7d",
              "30d"
            ]
          },
          "timezone": "browser",
          "title": "MongoDB",
          "uid": "f0e95a7cfe8cc479a68d7d839e1de4a1ac874486",
          "version": 4,
          "weekStart": ""
        }